$["fn"]["Km1by1"] = function (a) {
    a = $["extend"]({
        child: 'li',
        t: 80,
        before: function () { },
        after: function () { }
    }, a || {});
    return this["each"](function () {
        var b = $(this),
			c = $(a["child"], b)["not"](a["not"]),
			d = c["size"](),
			e = a["from"] || 0,
			f;
        a["before"]();

        function g() {
            if (e < d) {
                f = a["order"] ? d - e++ - 1 : e++;
                a["animate"](c["eq"](f), f);
                if (a["to"] && e >= a["to"]) {
                    a["after"]();
                    return false
                };
                setTimeout(function () {
                    g()
                }, a["t"])
            } else {
                e = 0;
                a["after"]()
            }
        };
        g()
    })
};
$(function () {
    var b = false,
		c;
    $('.menu-switcher')["on"]('click', function () {
        if (!b) {
            b = true;
            clearTimeout(c);
            $(this)["toggleClass"]('close');
            $('#menu')["toggleClass"]('on');
            $(this)["hasClass"]('close') ? setTimeout(function () {
                $('#menu')["Km1by1"]({
                    child: '.ani',
                    animate: function (x) {
                        x["addClass"]('on')
                    }
                })
            }, 200) : setTimeout(function () {
                $('#menu .ani')["removeClass"]('on')
            }, 300);
            c = setTimeout(function () {
                b = false
            }, 600)
        }
    });
    var d = $('.home-sec3')["swiper"]({
        pagination: '.pagination div',
        paginationClickable: true,
        simulateTouch: false,
        mousewheelControl: true,
        onSlideChangeEnd: function () {
            $('.swiper-slide-active')["addClass"]('current')["siblings"]()["removeClass"]('current')
        }
    });
    $('.pagination a')["on"]('click', function () {
        $(this)["hasClass"]('prev') ? d["swipePrev"]() : d["swipeNext"]();
        return false
    });
    $('#home-container')["append"]('<div class="shifter shifter1"></div><div class="shifter shifter2"></div><div id="pager-dot"><span class="current"></span><span></span><span></span><span></span></div>');
    var e = false,
		f = 1,
		g = 2,
		h = 100,
		i = $('.shifter1, .shifter2'),
		j = $('.shifter1'),
		k = $('.shifter2');
    $('#home-container, footer')["mousewheel"](function (x) {
        if (!e) {
            e = true;
            if (f == 3) {
                if (x["deltaY"] < 0 && $('.swiper-slide4')["hasClass"]('current')) {
                    u()
                } else if (x["deltaY"] > 0 && $('.swiper-slide1')["hasClass"]('current')) {
                    v()
                } else {
                    e = false
                }
            } else {
                x["deltaY"] < 0 ? u() : v()
            }
        }
    });
    var l = 0,
		m = 0,
		n = 0,
		o = 0,
		p = document["getElementById"]('home-container'),
		q = document["querySelector"]('footer');
    p["addEventListener"]('touchstart', r, false);
    p["addEventListener"]('touchend', s, false);
    q["addEventListener"]('touchstart', r, false);
    q["addEventListener"]('touchend', s, false);

    function r(x) {
        var x = event || window["event"];
        m = x["touches"][0]["clientX"];
        l = x["touches"][0]["clientY"]
    };

    function s(x) {
        var x = event || window["event"];
        n = x["changedTouches"][0]["clientX"];
        o = x["changedTouches"][0]["clientY"];
        if (!e) {
            e = true;
            if (Math["abs"](o - l) > Math["abs"](n - m)) {
                o - l < 100 && u();
                o - l > 100 && v()
            } else {
                e = false
            }
        }
    };
    $('#pager-dot span')["on"]('click', function () {
        if (!$(this)["hasClass"]('current') && !e) {
            e = true;
            g = $(this)["index"]() + 1;
            h = g > f ? 100 : -100;
            w()
        }
    });

    function u() {
        if (f >= 4) {
            if (!$('body')["hasClass"]('show-footer')) {
                $('body')["addClass"]('show-footer');
                setTimeout(function () {
                    e = false
                }, 500)
            } else {
                e = false
            }
        } else {
            g = f + 1;
            h = 100;
            w()
        }
    };

    function v() {
        if ($('body')["hasClass"]('show-footer')) {
            $('body')["removeClass"]('show-footer');
            setTimeout(function () {
                e = false
            }, 500)
        } else {
            g = f - 1;
            h = -100;
            g > 0 ? w() : e = false
        }
    };

    function w() {
        var x = $('.home-sec' + f),
			y = $('.home-sec' + g);
        $('#pager-dot span')["eq"](g - 1)["addClass"]('current')["siblings"]()["removeClass"]('current');
        i["css"]({
            transition: 'none',
            transform: 'translate(0,' + h + '%)'
        });
        x["css"]({
            zIndex: 15
        });
        y["show"]()["css"]({
            zIndex: 17,
            transition: 'none',
            transform: 'translate(0,' + h + '%)'
        });
        if (y["hasClass"]('home-sec3')) {
            d["resizeFix"]()
        };
        j["css"]({
            zIndex: 18,
            backgroundColor: '#' + y["data"]('color')
        });
        setTimeout(function () {
            j["css"]({
                transition: '1.2s cubic-bezier(.2,0,.5,1)',
                transform: 'translate(0,' + -h + '%)'
            })
        }, 20);
        setTimeout(function () {
            k["css"]({
                zIndex: 19,
                transition: '1.2s cubic-bezier(.2,0,.5,1)',
                transform: 'translate(0,' + -h + '%)'
            })
        }, 320);
        setTimeout(function () {
            y["css"]({
                transition: '.8s cubic-bezier(.2,0,.5,1)',
                transform: 'translate(0,0)'
            })
        }, 620);
        setTimeout(function () {
            y["addClass"]('current')["siblings"]()["removeClass"]('current');
            if (y["hasClass"]('home-sec3') && !$('.home-sec3 .current')["length"]) {
                $('.home-sec3 .swiper-slide-active')["addClass"]('current')
            } else {
                $('.home-sec3 .current')["removeClass"]('current')
            }
        }, 1200);
        setTimeout(function () {
            x["hide"]();
            e = false;
            f = g
        }, 1500)
    }
});
$(window).on('load', function () {
    setTimeout(function () {
        $('.home-sec2, .home-sec3, .home-sec4').hide();
        $('body, #home-container').addClass('loaded');
        setTimeout(function () {
            $('.home-sec1').addClass('current')
        }, 200);
        var R = Raphael('svg', 276, 246),
			iii = 0,
			points = ['M124.5,0L36.7,92c0,0,16.3,121,18.8,122.5S208,242,208,242l28.6-159L124.5,0z', 'M133,15c0,0-116.3,73-116.3,74.5S64.5,220,64.5,220l142,7l50.1-139.5L133,15z', 'M136.6,18c-2.6,0-135,48.5-135,48.5L57,224l141.5-34l73.1-122.5L136.6,18z'],
			elss = R.path(points[0]).attr({
			    fill: '#ff78fa',
			    stroke: 'none',
			    'fill-opacity': .6
			});
        (function ani() {
            iii = iii++ >= 2 ? 0 : iii;
            elss.stop().animate({
                path: points[iii]
            }, 2000, ani)
        })()
    }, 1000)
});